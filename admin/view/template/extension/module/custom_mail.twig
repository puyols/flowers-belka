{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
        <button type="submit" form="form-module" data-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
        <a href="{{ cancel }}" data-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a></div>
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    {% if error_warning %}
    <div class="alert alert-danger alert-dismissible"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
      <button type="button" class="close" data-dismiss="alert">&times;</button>
    </div>
    {% endif %}
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-pencil"></i> {{ text_edit }}</h3>
      </div>
      <div class="panel-body">
        <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-module" class="form-horizontal">
          <div class="form-group">
            <label class="col-sm-2 control-label" for="input-name">{{ entry_name }}</label>
            <div class="col-sm-10">
              <input type="text" name="name" value="{{ name }}" placeholder="{{ entry_name }}" id="input-name" class="form-control" />
              {% if error_name %}
              <div class="text-danger">{{ error_name }}</div>
              {% endif %}
            </div>
          </div>


          <div class="form-group">
            <label class="col-sm-2 control-label" for="input-description">{{ entry_description }}</label>
            <div class="col-sm-10">
              <textarea name="description" rows="1" placeholder="{{ entry_description }}" id="input-description" data-toggle="summernote" class="form-control">{{ description }}</textarea>
              {% if error_description %}
                <div class="text-danger">{{ error_description }}</div>
              {% endif %}
            </div>
          </div>
          


          <div class="form-group">
            <label class="col-sm-2 control-label" for="input-bottom">{{ entry_bottom }}</label>
            <div class="col-sm-10">
              <input type="text" name="name_bottom" value="{{ name_bottom }}" placeholder="{{ entry_bottom }}" id="input-bottom" class="form-control" />

            </div>
          </div>

          <div class="form-group">
            <label class="col-sm-2 control-label" for="input-status">{{ entry_status }}</label>
            <div class="col-sm-10">
              <select name="status" id="input-status" class="form-control">
                {% if status %}
                <option value="1" selected="selected">{{ text_enabled }}</option>
                <option value="0">{{ text_disabled }}</option>
                {% else %}
                <option value="1">{{ text_enabled }}</option>
                <option value="0" selected="selected">{{ text_disabled }}</option>
                {% endif %}
              </select>
            </div>
          </div>
          <div class="col-md-12"><div class="form-group"><div class="block_result_settings"><h4 class="text-center">Дополнительные настройки<div class="view_fa_block_options_product pull-right"></div></h4> </div></div></div>

            <table class="table table-striped table-bordered table-hover">
              <thead>
              <tr>
                <td class="text-left">{{ entry_imageGl }}</td>
                <td class="text-left">{{ entry_mask }}</td>
                <td class="text-left">{{ entry_color_text }}</td>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td class="text-left"><a href="" id="thumb-image" data-toggle="image" class="img-thumbnail"><img src="{{ thumb }}" alt="" title="" data-placeholder="{{ placeholder }}"/></a> <input type="hidden" name="image" value="{{ image }}" id="input-image"/></td>
                <td class="text-left"><input type="text" name="mask" value="{{ mask }}" placeholder="{{ entry_mask }}" class="form-control" />
                <td class="text-left"><div class="col-sm-12 input-group form_color">
                    <input type="text" name="color_text" value="{{ color_text }}" placeholder="#3FB8AF"  class="form-control"><span class="input-group-addon"><i style="border: 1px solid rgb(0, 0, 0); background-color: #EEEEEE;"></i></span>
                  </div>
                </td>
              </tr>
              </tbody>
            </table>

          <div class="col-md-12"><div class="form-group"><div class="block_result_settings"><h4 class="text-center">Генерация полей формы<div class="view_fa_block_options_product pull-right"></div></h4> </div></div></div>
          {% set image_row = 0 %}
          <table id="images" class="table table-striped table-bordered table-hover">
            <thead>
            <tr>
              <td class="text-center">{{ entry_title }}</td>
              <td class="text-center">{{ entry_placeholder }}</td>
              <td class="text-center">{{ entry_select_form }}</td>
              <td class="text-left">{{ entry_select_name }}</td>
              <td class="text-center">{{ entry_color }}</td>
              <td class="text-center">{{ entry_color_text_in }}</td>
              <td class="text-left">{{ entry_required }}</td>
              <td class="text-center">{{ entry_icons }}</td>
              <td></td>
            </tr>
            </thead>
            <tbody>
            {% if forms %}
              {% for key, form_mail in forms %}
                <tr id="image-row{{ image_row }}">
                  <td class="text-left"><input type="text" name="form_mail[{{ image_row }}][title]" value="{{ form_mail.title }}" placeholder="{{ entry_title }}" class="form-control" />
                  <td class="text-left"><input type="text" name="form_mail[{{ image_row }}][placeholder]" value="{{ form_mail.placeholder }}" placeholder="{{ entry_placeholder }}" class="form-control" />
                    {% if error_form_mail[image_row] %}
                      <div class="text-danger">{{ error_form_mail[image_row] }}</div>
                    {% endif %}</td>
                  <td class="text-left" style="width: 100%;display: flex;">
                    <select name="form_mail[{{ image_row }}][select_form]" data-id="{{ image_row }}" class="form-control form-select">
                      {% if form_mail.select_form %}
                        <option value="text" {% if form_mail.select_form == "text"%}selected="selected"{% endif %}>{{ entry_text }}</option>
                        <option value="checkbox" {% if form_mail.select_form == "checkbox"%}selected="selected"{% endif %}>{{ entry_checkbox }}</option>
                        <option value="radio" {% if form_mail.select_form == "radio"%}selected="selected"{% endif %}>{{ entry_radio }}</option>
                        <option value="select" {% if form_mail.select_form == "select"%}selected="selected"{% endif %}>{{ entry_select }}</option>
                        <option value="textarea" {% if form_mail.select_form == "textarea"%}selected="selected"{% endif %}>{{ entry_textarea }}</option>
                        <option value="email" {% if form_mail.select_form == "email"%}selected="selected"{% endif %}>{{ entry_email }}</option>
                        <option value="tel" {% if form_mail.select_form == "tel"%}selected="selected"{% endif %}>{{ entry_tel }}</option>
                        <option value="date" {% if form_mail.select_form == "date"%}selected="selected"{% endif %}>{{ entry_date }}</option>
                        <option value="file" {% if form_mail.select_form == "file"%}selected="selected"{% endif %}>{{ entry_file }}</option>
                      {% else %}
                        <option value="text" selected="selected">{{ entry_text }}</option>
                        <option value="checkbox">{{ entry_checkbox }}</option>
                        <option value="radio">{{ entry_radio }}</option>
                        <option value="select">{{ entry_select }}</option>
                        <option value="textarea">{{ entry_textarea }}</option>
                        <option value="email">{{ entry_email }}</option>
                        <option value="tel">{{ entry_tel }}</option>
                        <option value="date">{{ entry_date }}</option>
                        <option value="file">{{ entry_file }}</option>
                      {% endif %}
                    </select>
                  </td>
                  <td class="text-center" style="width: 15%;"><input type="text" name="form_mail[{{ image_row }}][input_name]" value="{{ form_mail.input_name }}" placeholder="{{ entry_name_input }}" class="form-control" />
                    {% if error_input_name[key] %}
                      <div class="text-danger">{{ error_input_name[key] }}</div>
                    {% endif %}
                  </td>

                  <td class="text-right" style="width: 10%;">
                    <div class="col-sm-12 input-group form_color">
                      <input type="text" name="form_mail[{{ image_row }}][color]" value="{{ form_mail.color }}" placeholder="#3FB8AF"  class="form-control"><span class="input-group-addon"><i style="border: 1px solid rgb(0, 0, 0); background-color: #EEEEEE;"></i></span>
                    </div>
                  </td>
                  <td class="text-right" style="width: 10%;">
                    <div class="col-sm-12 input-group form_color">
                      <input type="text" name="form_mail[{{ image_row }}][color_text]" value="{{ form_mail.color_text }}" placeholder="#3FB8AF"  class="form-control"><span class="input-group-addon"><i style="border: 1px solid rgb(0, 0, 0); background-color: #EEEEEE;"></i></span>
                    </div>
                  </td>
                  <td class="text-center" style="width: 10%;"><input type="checkbox" name="form_mail[{{ image_row }}][required]" value="{{ form_mail.required }}" {% if form_mail.required %} checked='checked' {% endif %}" class="form-control" /></td>
                  <td class="text-center"><a href="" id="thumb-image{{ image_row }}" data-toggle="image" class="form_icons"><img src="{{ form_mail.thumb }}" alt="" title="" data-placeholder="{{ placeholder_form }}" /></a>
                    <input type="hidden" name="form_mail[{{ image_row }}][image]" value="{{ form_mail.image }}" id="input-image{{ image_row }}" /></td>

                  <td class="text-left"><button type="button" onclick="$('#image-row{{ image_row }}, .option{{ image_row }} , .tooltip').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>
                </tr>
                {% if form_mail.select_form == "radio"%}

                      <tr class="option{{ image_row }}" id="radio-row{{ image_row }}">
                        <td class="text-left" style="display:block"><button type="button" onclick="addRadio('#radio-row{{ image_row }}', '{{ image_row }}', 'radio');" data-toggle="tooltip" title="{{ button_banner_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                {% if form_mail.radio %}
                  {% for radio in form_mail.radio %}
                        <th class="text-left" style="display:flex"><input type="text" name="form_mail[{{ image_row }}][radio][]" value="{{ radio }}" placeholder="{{ entry_radio_text }}" class="form-control" />
                         <button type="button" onclick="$(this).parent().remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></th>
                  {% endfor %}
                {% endif %}
                      </tr>
                {% endif %}
                {% if form_mail.select_form == "checkbox"%}

                  <tr class="option{{ image_row }}" id="checkbox-row{{ image_row }}">
                    <td class="text-left" style="display:block"><button type="button" onclick="addRadio('#checkbox-row{{ image_row }}', '{{ image_row }}', 'checkbox');" data-toggle="tooltip" title="{{ button_banner_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                    {% if form_mail.checkbox %}
                      {% for checkbox in form_mail.checkbox %}
                        <th class="text-left" style="display:flex"><input type="text" name="form_mail[{{ image_row }}][checkbox][]" value="{{ checkbox }}" placeholder="{{ entry_checkbox_text }}" class="form-control" />
                          <button type="button" onclick="$(this).parent().remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></th>
                      {% endfor %}
                    {% endif %}
                  </tr>
                {% endif %}
                {% if form_mail.select_form == "select"%}

                  <tr class="option{{ image_row }}" id="select-row{{ image_row }}">
                    <td class="text-left" style="display:block"><button type="button" onclick="addRadio('#select-row{{ image_row }}', '{{ image_row }}', 'select');" data-toggle="tooltip" title="{{ button_banner_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                    {% if form_mail.select %}
                      {% for select in form_mail.select %}
                        <th class="text-left" style="display:flex"><input type="text" name="form_mail[{{ image_row }}][select][]" value="{{ select }}" placeholder="{{ entry_select_text }}" class="form-control" />
                          <button type="button" onclick="$(this).parent().remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></th>
                      {% endfor %}
                    {% endif %}
                  </tr>
                {% endif %}
                {% set image_row = image_row + 1 %}

              {% endfor %}
            {% endif %}
            </tbody>
            <tfoot>
            <tr>
              <td colspan="7"></td>
              <td class="text-left"><button type="button" onclick="addImage();" data-toggle="tooltip" title="{{ button_banner_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
            </tr>

            </tfoot>
          </table>
          {% if error_email %}
            <div class="text-danger text-center">{{ error_email }}</div>
          {% endif %}
        </form>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript" src="view/javascript/summernote/summernote.js"></script>
<link href="view/javascript/summernote/summernote.css" rel="stylesheet"/>
<script type="text/javascript" src="view/javascript/summernote/summernote-image-attributes.js"></script>
<script type="text/javascript" src="view/javascript/summernote/opencart.js"></script>

<script type="text/javascript"><!--
$('input[type=\'radio\']').lc_switch();

// triggered each time a field changes status
$(document).on('lcs-statuschange', '.lcs_check', function() {
var status 	= ($(this).is(':checked')) ? 'checked' : 'unchecked',
subj 	= ($(this).attr('type') == 'radio') ? 'radio #' : 'checkbox #',
num		= $(this).val();

});

// triggered each time a field is checked
$(document).on('lcs-on', '.lcs_check', function() {
var subj 	= ($(this).attr('type') == 'radio') ? 'radio #' : 'checkbox #',
num		= $(this).val();

});

// triggered each time a is unchecked
$(document).on('lcs-off', '.lcs_check', function() {
var subj 	= ($(this).attr('type') == 'radio') ? 'radio #' : 'checkbox #',
num		= $(this).val();


});
  var image_row = {{ image_row }};

  function addImage() {
    html  = '<tr id="image-row' + image_row + '">';
    html += '  <td class="text-left"><input type="text" name="form_mail[' + image_row + '][title]" value="" placeholder="{{ entry_title }}" class="form-control" /></td>';
    html += '  <td class="text-left"><input type="text" name="form_mail[' + image_row + '][placeholder]" value="" placeholder="{{ entry_placeholder }}" class="form-control" /></td>';
    html += '  <td class="text-left" style="width: 100%;display: flex;"><select name="form_mail[' + image_row + '][select_form]"  data-id="' + image_row + '" class="form-control form-select">';
    html += '        <option value="text" selected="selected">{{ entry_text }}</option>';
    html += '        <option value="checkbox">{{ entry_checkbox }}</option>';
    html += '        <option value="radio">{{ entry_radio }}</option>';
    html += '        <option value="select">{{ entry_select }}</option>';
    html += '        <option value="textarea">{{ entry_textarea }}</option>';
    html += '        <option value="email">{{ entry_email }}</option>';
    html += '        <option value="tel">{{ entry_tel }}</option>';
    html += '        <option value="date">{{ entry_date }}</option>';
    html += '        <option value="file">{{ entry_file }}</option>';
    html += '  </select></td>';
    html += '  <td class="text-left" style="width: 15%;"><input type="text" name="form_mail[' + image_row + '][input_name]" value="" placeholder="{{ entry_name_input }}" class="form-control" /></td>';
    html += ' <td class="text-right" style="width: 10%;"><div class="col-sm-12 input-group form_color"><input type="text" name="form_mail[' + image_row + '][color]" value="" placeholder="#3FB8AF"  class="form-control"><span class="input-group-addon"><i style="border: 1px solid rgb(0, 0, 0); background-color: #EEEEEE;"></i></span></div></td>';
    html += ' <td class="text-right" style="width: 10%;"><div class="col-sm-12 input-group form_color"><input type="text" name="form_mail[' + image_row + '][color_text]" value="" placeholder="#3FB8AF"  class="form-control"><span class="input-group-addon"><i style="border: 1px solid rgb(0, 0, 0); background-color: #EEEEEE;"></i></span></div></td>';
    html += ' <td class="text-center" style="width: 10%;"><input type="checkbox" name="form_mail[' + image_row + '][required]" value=""  class="form-control" /></td>';
    html += '  <td class="text-center"><a href="" id="thumb-image' + image_row + '" data-toggle="image" class="form_icons"><img src="{{ placeholder_form }}" alt="" title="" data-placeholder="{{ placeholder_form }}" /></a><input type="hidden" name="form_mail[' + image_row + '][image]" value="" id="input-image' + image_row + '" /></td>';

    html += '  <td class="text-left"><button type="button" onclick="$(\'#image-row' + image_row  + ', .option' + image_row  + ', .tooltip\').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>';
    html += '</tr>';

    $('#images  tbody').append(html);

    image_row++;
    $('.form-select').change(function () {
      changeSelect($(this));

    });
    $('.form_color').colorpicker();
    $('input[type=\'checkbox\']').checkboxpicker({html: true, onLabel:'Да', offLabel:'Нет'});
    $('input[type=\'checkbox\']').change(function () {
      var in_val = $(this);
      if ($(this).is(':checked')){
        var input = '1';
      } else {
        var input = '0';
      }
      in_val.attr('value',input);
    });
  }
  var addRadio = function(row_id, id, type) {
    if (type == 'radio') {
      var entry = '{{ entry_radio_text }}';
    } else if (type == 'select') {
      var entry = '{{ entry_select_text }}';
    } else if (type == 'checkbox') {
      var entry = '{{ entry_checkbox_text }}';
    }

    html = '  <th class="text-left" style="display:flex"><input type="text" name="form_mail[' + id + '][' + type + '][]" value="" placeholder="' + entry + '" class="form-control" />';
    html += ' <button type="button" onclick="$(this).parent().remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></th>';
    $(row_id).append(html);
  }
  $('.form-select').change(function () {
    changeSelect($(this));
  });
  $('.form_color').colorpicker();
  $('input[type=\'checkbox\']').checkboxpicker({html: true, onLabel:'Да', offLabel:'Нет'});
  $('input[type=\'checkbox\']').change(function () {
    var in_val = $(this);
    if ($(this).is(':checked')){
      var input = '1';
    } else {
      var input = '0';
    }
    in_val.attr('value',input);
  });
  function changeSelect(option) {
    if(option.val() == 'radio' || option.val() == 'select' || option.val() == 'checkbox') {
      if(option.val() == 'radio') {
        $('#select-row'+option.data('id')).hide();
        $('#checkbox-row'+option.data('id')).hide();
      } else if (option.val() == 'select') {
        $('#radio-row'+option.data('id')).hide();
        $('#checkbox-row'+option.data('id')).hide();
      } else if (option.val() == 'checkbox') {
        $('#radio-row'+option.data('id')).hide();
        $('#select-row'+option.data('id')).hide();
      }
      if(option.closest('table').find('#'+option.val()+'-row'+option.data('id')).length) {
        $('#'+option.val()+'-row'+option.data('id')).show();
      } else {
        html = '<tr class="option' + option.data('id') + '" id="'+option.val()+'-row' + option.data('id') + '">';
        html += '<td class="text-left" style="display:block;"><button type="button" onclick="addRadio(\'#'+option.val()+'-row' + option.data('id') +'\',\''+option.data('id')+'\', \''+option.val()+'\');" data-toggle="tooltip" title="{{ button_banner_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>';
        html += '</tr>';

        option.closest('tr').after(html);
        $('#'+option.val()+'-row' + option.data(option.val())).show();
      }
    } else {
      $('#radio-row'+option.data('id')).hide();
      $('#select-row'+option.data('id')).hide();
      $('#checkbox-row'+option.data('id')).hide();
    }
  }
//--></script>
<style>
  .block_result_settings {
    background-color: #292929;
    text-shadow: 0px 1px 2px rgba(0,0,0,0.4);
    border-radius: 4px;
    padding: 10px;
    color: #fff;
    position: relative;
  }
.form_icons {
  width: auto;
  padding: 4px;
  line-height: 1.42857;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 3px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
}
  .form_icons img {
    width: 30px;
    height: 30px;
  }
  </style>
{{ footer }}